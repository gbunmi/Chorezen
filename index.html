// Debug function to check if orders are being populated
function checkOrderData() {
    console.log("Total Orders:", orders.length);
    if (orders.length > 0) {
        console.log("First Order:", orders[0]);
    }
}

function updateOrdersTable() {
    const tableBody = document.getElementById('ordersTableBody');
    tableBody.innerHTML = ''; // Clear existing rows

    console.log("Updating orders table. Total orders:", orders.length);

    orders.forEach((order, index) => {
        const row = tableBody.insertRow();
        
        // Add console log to verify each order
        console.log(`Order ${index}:`, order);

        // Add explicit click event listener with debugging
        row.addEventListener('click', () => {
            console.log("Row clicked. Order details:", order);
            showOrderDetails(order);
        });

        row.innerHTML = `
            <td>${order.customerName}</td>
            <td>${order.cleanerName}</td>
            <td>${order.date}</td>
            <td>${order.address}</td>
            <td>₦${order.servicePrice}</td>
            <td>₦${order.transport}</td>
            <td>${order.companyPercentage}%</td>
            <td>${order.discountPercentage}%</td>
            <td>₦${order.totalWorkerPayment}</td>
        `;
    });
}

function showOrderDetails(order) {
    console.log("Show order details called with:", order);
    
    const modal = document.getElementById('orderDetailsModal');
    const content = document.getElementById('orderDetailsContent');

    if (!modal || !content) {
        console.error("Modal or content element not found!");
        return;
    }

    // Simplified details display
    content.innerHTML = `
        <h2>Order Details</h2>
        <p>Customer: ${order.customerName}</p>
        <p>Cleaner: ${order.cleanerName}</p>
        <p>Date: ${order.date}</p>
        <p>Service Price: ₦${order.servicePrice}</p>
        <p>Total Worker Payment: ₦${order.totalWorkerPayment}</p>
    `;

    modal.style.display = 'block';
    console.log("Modal should now be visible");
}

function closeOrderDetailsModal() {
    document.getElementById('orderDetailsModal').style.display = 'none';
}

// Add a debug call to check data on page load
document.addEventListener('DOMContentLoaded', () => {
    checkOrderData();
});
